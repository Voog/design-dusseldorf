var debounce=function(e,t,i){var n;return function(){var o=this,a=arguments,s=i&&!n;clearTimeout(n),n=setTimeout(function(){n=null,i||e.apply(o,a)},t),s&&e.apply(o,a)}},toggleFlags=function(){$(".js-option-toggle-flags").on("click",function(e){if(e.stopPropagation(),$(this).hasClass("js-flag-disable-btn"))var t=!1;else t=!0;$(this).toggleClass("js-flag-disable-btn"),$(".js-menu-lang-wrap").toggleClass("flags-enabled flags-disabled"),siteData.set("flags_state",t)})},initSettingsEditorBtn=function(){window.addEventListener("DOMContentLoaded",function(e){var t=document.querySelector(".edy-next-shadowdom").shadowRoot,i=setInterval(function(){if(t.querySelectorAll('div[class^="toolbar__"]').length){var e=t.querySelector('div[class^="toolbar-expand"]'),n=t.querySelector('div[class^="toolbar__"]'),o=document.querySelector(".js-layout_settings-btn"),a=t.querySelector('div[class^="toolbar-content-item__"]');o.className=a.className+" "+o.className,n.insertBefore(o,e),t.querySelector(".js-layout_settings-btn").addEventListener("click",function(e){document.querySelector("body").classList.contains("layout_settings-visible")&&(document.querySelector("div.editor_default").style.display="none"),document.querySelector("body").classList.toggle("layout_settings-visible"),e.stopImmediatePropagation()});var s=function(){var e=$(".js-layout_settings-popover"),t=$(".layout_settings-arrow");$(window).width()>768?(e.css({right:window.innerWidth-o.getBoundingClientRect().right-e.width()/2}),t.css({right:e.width()/2})):(e.css({right:0}),t.css({right:72}))};$(window).resize(debounce(function(){s()},25)),s(),clearInterval(i)}},500);$("body").append($(".js-layout_settings-popover"))})},setEqualHeights=function(){if($(document).width()>=1024){$(".center-row").height(),$(".content-left").height(),$(".content-right").height();var e=$(".content-left .content-inner").height(),t=$(".content-right .content-inner").height(),i=$(".content-left .content-inner .inner-bottom").height(),n=$(".content-right .content-inner .inner-bottom").height();i>n&&$(".content-right .content-inner").animate({"min-height":e},"slow"),n>i&&$(".content-left .content-inner").animate({"min-height":t},"slow")}var o=$(".content-left .content-inner").height(),a=$(".content-right .content-inner").height(),s=$(".content-left .content-inner .inner-bottom").height(),r=$(".content-right .content-inner .inner-bottom").height();o<s?$(".center-row .content-left .inner-bottom").css("position","relative"):s<o&&$(".center-row .content-left .inner-bottom").css("position","absolute"),a<r?$(".center-row .content-right .inner-bottom").css("position","relative"):r<a&&$(".center-row .content-right .inner-bottom").css("position","absolute")},setTitlebox=function(){var e=$(".site-title:visible");e.is(":empty")&&$(".site-title-editable").appendTo(e)},setHeaderMenuInitialWidth=function(){var e=$(".js-header-menu");e.attr("data-initial-width",e.outerWidth(!0))};if($("body").hasClass("editmode")){setTitlebox(),$(window).resize(debounce(setTitlebox,100));var delay=function(){var e=0;return function(t,i){clearTimeout(e),e=setTimeout(t,i)}}();$(".center-row .content-inner").keyup(function(){delay(function(){setEqualHeights()},350)})}var editmode=function(){return $("html").hasClass("editmode")};!Modernizr.flexbox&&editmode()&&(bindFallbackHeaderContentAreaWidthCalculation(),bindFallbackFooterContentAreaWidthCalculation());var bindContentItemImgDropAreas=function(e){$(".js-content-item-img-drop-area").each(function(t,i){var n=$(i),o=n.closest(".js-content-item-box"),a=o.data("item-id"),s=o.data("item-type");new Edicy.CustomData({type:s,id:a}),new Edicy.ImgDropArea(n,{positionable:!1,target_width:1280,placeholder:'<div class="edy-img-drop-area-placeholder">'+e+"</div>",removeBtn:'<div class="edy-img-drop-area-remove-image"><div class="edy-img-drop-area-remove-image-ico"><svg width="16" height="20" viewBox="0 0 26 30" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="currentColor"><g transform="translate(2 5)"><path d="M0 .997h2V21c0 1 1 2 2 2h14c1 0 2-1 2-2V1h2v20c0 2.25-1.75 4-4 4H4c-2.25 0-4-1.75-4-4V.997z"/><rect x="10" y="4" width="2" height="16" rx="1"/><rect x="5" y="4" width="2" height="16" rx="1"/><rect x="15" y="4" width="2" height="16" rx="1"/></g><path d="M26 4v2H0V4h7V2c0-1 1-2 2-2h8c1 0 2 1 2 2v2h7zM9 4h8V3c0-.5-.5-1-1-1h-6c-.5 0-1 .5-1 1v1z"/></g></svg></div></div>',change:function(e){var t;n.removeClass("is-cropped").addClass("not-cropped").css("opacity",.1),e?(t=e.original_id,o.removeClass("without-image is-loaded with-error").addClass("with-image not-loaded"),setImageOrientation(o,e.width,e.height)):(t=null,o.removeClass("with-image is-loaded with-error").addClass("without-image not-loaded"),o.find(".edy-img-drop-area-placeholder").css("opacity",0)),setItemImage(o,n,a,t,s)}})})},setImageOrientation=function(e,t,i){var n=e.find(".js-content-item-img-drop-area"),o=e.find(".js-toggle-crop-state");t>i?n.removeClass("image-landscape image-square image-portrait").addClass("image-landscape"):t===i?n.removeClass("image-landscape image-square image-portrait").addClass("image-square"):n.removeClass("image-landscape image-square image-portrait").addClass("image-portrait"),n.hasClass("image-square")?o.removeClass("is-visible").addClass("is-hidden"):o.removeClass("is-hidden").addClass("is-visible")},setItemImage=function(e,t,i,n,o){var a="article"===o?"articles":"pages",s=new Edicy.CustomData({type:o,id:i});$.ajax({type:"PATCH",contentType:"application/json",url:"/admin/api/"+a+"/"+i,data:JSON.stringify({image_id:n}),dataType:"json",success:function(i){s.set("image_crop_state","not-cropped"),e.removeClass("not-loaded with-error").addClass("is-loaded"),e.find(".edy-img-drop-area-placeholder").css("opacity",1),t.css("opacity",1)},timeout:3e4,error:function(t){e.removeClass("not-loaded is-loaded with-error").addClass("with-error")}})};window.site=$.extend(window.site||{},{bindContentItemImgDropAreas:bindContentItemImgDropAreas,initSettingsEditorBtn:initSettingsEditorBtn,toggleFlags:toggleFlags});