var MMCQ,PriorityQueue;PriorityQueue=function(){function t(t){this.comparator=t,this.contents=[],this.sorted=!1}return t.prototype.sort=function(){return this.contents.sort(this.comparator),this.sotred=!0},t.prototype.push=function(t){return this.contents.push(t),this.sorted=!1},t.prototype.peek=function(t){return null==t&&(t=this.contents.length-1),this.sorted||this.sort(),this.contents[t]},t.prototype.pop=function(){return this.sorted||this.sort(),this.contents.pop()},t.prototype.size=function(){return this.contents.length},t.prototype.map=function(t){return this.contents.map(t)},t}(),MMCQ=function(){var t,e,o,n,i,r;function s(){this.maxIterations=1e3,this.fractByPopulations=.75}return s.sigbits=5,s.rshift=8-s.sigbits,n=function(t,e,o){return(t<<2*s.sigbits)+(e<<s.sigbits)+o},t=function(){function t(t,e,o,n,i,r,s){this.r1=t,this.r2=e,this.g1=o,this.g2=n,this.b1=i,this.b2=r,this.histo=s}return t.prototype.volume=function(t){return this._volume&&!t||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},t.prototype.count=function(t){var e,o,i,r,s,a,c,l,h,u,d;if(!this._count_set||t){for(r=0,s=a=this.r1,h=this.r2;a<=h;s=a+=1)for(o=c=this.g1,u=this.g2;c<=u;o=c+=1)for(e=l=this.b1,d=this.b2;l<=d;e=l+=1)i=n(s,o,e),r+=this.histo[i]||0;this._count_set=!0,this._count=r}return this._count},t.prototype.copy=function(){return new t(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},t.prototype.average=function(t){var e,o,i,r,a,c,l,h,u,d,f,p,g,m,b,v;if(!this._average||t){for(l=1<<8-s.sigbits,d=0,u=0,r=0,o=0,h=f=this.r1,m=this.r2;f<=m;h=f+=1)for(i=p=this.g1,b=this.g2;p<=b;i=p+=1)for(e=g=this.b1,v=this.b2;g<=v;e=g+=1)c=n(h,i,e),d+=a=this.histo[c]||0,u+=a*(h+.5)*l,r+=a*(i+.5)*l,o+=a*(e+.5)*l;this._average=d?[~~(u/d),~~(r/d),~~(o/d)]:[~~(l*(this.r1+this.r2+1)/2),~~(l*(this.g1+this.g2+1)/2),~~(l*(this.b1+this.b2+1)/2)]}return this._average},t.prototype.contains=function(t){var e,o,n;return n=t[0]>>s.rshift,o=t[1]>>s.rshift,e=t[2]>>s.rshift,this.r1<=n&&n<=this.r2&&this.g1<=o&&o<=this.g2&&this.b1<=e&&e<=this.b2},t}(),e=function(){function t(){this.cboxes=new PriorityQueue(function(t,e){var o,n;return(o=t.count()*t.volume())>(n=e.count()*e.volume())?1:o<n?-1:0})}return t.prototype.push=function(t){return this.cboxes.push({cbox:t,color:t.average()})},t.prototype.palette=function(){return this.cboxes.map(function(t){return t.color})},t.prototype.size=function(){return this.cboxes.size()},t.prototype.map=function(t){var e,o,n;for(e=o=0,n=this.cboxes.size();o<n;e=o+=1)return this.cboxes.peek(e).cbox.contains(t)?this.cboxes.peek(e).color:this.nearest(t)},t.prototype.cboxes=function(){return this.cboxes},t.prototype.nearest=function(t){var e,o,n,i,r,s,a;for(r=function(t){return t*t},n=1e9,o=s=0,a=this.cboxes.size();s<a;o=s+=1)(e=Math.sqrt(r(t[0]-this.cboxes.peek(o).color[0])+r(t[1]-this.cboxes.peek(o).color[1])+r(t[2]-this.cboxes.peek(o).color[2])))<n&&(n=e,i=this.cboxes.peek(o).color);return i},t}(),i=function(t){var e,o,i,r,a,c,l,h,u;for(r=1<<3*s.sigbits,i=new Array(r),h=0,u=t.length;h<u;h++)l=(c=t[h])[0]>>s.rshift,o=c[1]>>s.rshift,e=c[2]>>s.rshift,i[a=n(l,o,e)]=(i[a]||0)+1;return i},o=function(e,o){var n,i,r,a,c,l,h,u,d,f,p,g;for(f=1e6,d=0,l=1e6,c=0,r=1e6,i=0,p=0,g=e.length;p<g;p++)u=(h=e[p])[0]>>s.rshift,a=h[1]>>s.rshift,n=h[2]>>s.rshift,u<f?f=u:u>d&&(d=u),a<l?l=a:a>c&&(c=a),n<r?r=n:n>i&&(i=n);return new t(f,d,l,c,r,i,o)},r=function(t,e){var o,i,r,s,a,c,l,h,u,d,f,p,g,m,b,v,y,w,C,_,x,j,z,A,k,M,D,I,B,q;if(e.count()){if(1===e.count())return[e.copy()];if(d=e.r2-e.r1+1,a=e.g2-e.g1+1,i=e.b2-e.b1+1,l=Math.max(d,a,i),p=0,h=[],c=[],l===d)for(u=g=e.r1,j=e.r2;g<=j;u=g+=1){for(f=0,s=m=e.g1,D=e.g2;m<=D;s=m+=1)for(o=b=e.b1,I=e.b2;b<=I;o=b+=1)f+=t[n(u,s,o)]||0;p+=f,h[u]=p}else if(l===a)for(s=v=e.g1,B=e.g2;v<=B;s=v+=1){for(f=0,u=y=e.r1,q=e.r2;y<=q;u=y+=1)for(o=w=e.b1,z=e.b2;w<=z;o=w+=1)f+=t[n(u,s,o)]||0;p+=f,h[s]=p}else for(o=C=e.b1,A=e.b2;C<=A;o=C+=1){for(f=0,u=_=e.r1,k=e.r2;_<=k;u=_+=1)for(s=x=e.g1,M=e.g2;x<=M;s=x+=1)f+=t[n(u,s,o)]||0;p+=f,h[o]=p}return h.forEach(function(t,e){return c[e]=p-t}),r=function(t){var o,n,i,r,s,a,l,u,d,f,g;for(a=t+"2",l=f=e[s=t+"1"],g=e[a];f<=g;l=f+=1)if(h[l]>p/2){for(o=e.copy(),n=e.copy(),r=(u=l-e[s])<=(d=e[a]-l)?Math.min(e[a]-1,~~(l+d/2)):Math.max(e[s],~~(l-1-u/2));!h[r];)r++;for(i=c[r];!i&&h[r-1];)i=c[--r];return o[a]=r,n[s]=o[a]+1,[o,n]}},l===d?r("r"):l===a?r("g"):l===i?r("b"):void 0}},s.prototype.quantize=function(t,n){var s,a,c,l,h,u,d=this;if(!t.length||n<2||n>256)return console.log("invalid arguments"),!1;for(c=i(t),s=o(t,c),(h=new PriorityQueue(function(t,e){var o,n;return(o=t.count())>(n=e.count())?1:o<n?-1:0})).push(s),(l=function(t,e){var o,n,i,a,l;for(a=1,l=0;l<d.maxIterations;)if((s=t.pop()).count()){if(o=(i=r(c,s))[0],n=i[1],!o)return void console.log("cbox1 not defined; shouldn't happen");if(t.push(o),n&&(t.push(n),a++),a>=e)return;if(l++>d.maxIterations)return void console.log("infinite loop; perhaps too few pixels")}else t.push(s),l++})(h,this.fractByPopulations*n),u=new PriorityQueue(function(t,e){var o,n;return(o=t.count()*t.volume())>(n=e.count()*e.volume())?1:o<n?-1:0});h.size();)u.push(h.pop());for(l(u,n-u.size()),a=new e;u.size();)a.push(u.pop());return a},s}.call(this),function(){window.ColorExtract=function(){function t(){}return t.getColorMap=function(t,e,o,n,i,r){var s,a,c,l,h,u,d,f,p,g;for(null==r&&(r=8),c=t.getContext("2d").getImageData(e,o,n,i).data,l=[],u=d=o,p=o+i;d<p;u=d+=1)for(a=u*n*4,h=f=e,g=e+n;f<g;h=f+=1)s=a+4*h,l.push([c[s],c[s+1],c[s+2]]);return(new MMCQ).quantize(l,r)},t.colorDist=function(t,e){var o;return(o=function(t){return t*t})(t[0]-e[0])+o(t[1]-e[1])+o(t[2]-e[2])},t.extract=function(e,o,n){var i,r,s,a,c,l,h,u,d,f,p,g,m;for(o.width=25,o.height=25,o.getContext("2d").drawImage(e,0,0,o.width,o.height),(r=t.getColorMap(o,0,0,o.width,o.height,4).cboxes.map(function(t){return{count:t.cbox.count(),rgb:t.color}})).sort(function(t,e){return e.count-t.count}),i=r[0].rgb,(h=t.getColorMap(o,0,0,e.width,e.height,10).cboxes.map(function(t){return{count:t.cbox.count(),rgb:t.color}})).sort(function(t,e){return e.count-t.count}),u=0,f=0,g=h.length;f<g;f++)s=h[f],(a=t.colorDist(i,s.rgb))>u&&(u=a,c=s.rgb);for(u=0,p=0,m=h.length;p<m;p++)s=h[p],(a=t.colorDist(i,s.rgb))>u&&s.rgb!==c&&(u=a,l=s.rgb);return n({bgColor:(d=function(t){return"rgb("+t[0]+", "+t[1]+", "+t[2]+")"})(i),fgColor:d(c),fgColor2:d(l)})},t}()}.call(this),function(t){t(function(){var n=function(t,e,o){var n;return function(){var i=this,r=arguments,s=o&&!n;clearTimeout(n),n=setTimeout(function(){n=null,o||t.apply(i,r)},e),s&&t.apply(i,r)}};t(".js-popup-menu").jsPopupMenu(),t("html").hasClass("no-placeholder")&&t('input[type="text"],textarea').each(function(){t(this).attr("placeholder")&&!t(this).val()&&t(this).val(t(this).attr("placeholder")),t(this).focus(function(){t(this).val()==t(this).attr("placeholder")&&t(this).val("")}).blur(function(){!t(this).val()&&t(this).attr("placeholder")&&t(this).val(t(this).attr("placeholder"))})}),t(".form_fields:not(.edy-fe-fields) select, .custom-select").jqSelect(),t("body:not(.editmode) table").each(function(){t(this).wrap('<div class="table-holder" />')}),t(".mobile-menu-toggler").click(function(e){e.preventDefault(),t("body").toggleClass("mobilemenu-open"),t("body").removeClass("mobilesearch-open"),t(".edy-ecommerce-shopping-cart-button").hide()}),t(".mobile-menu-close").on("click",function(e){e.preventDefault(),t("body").hasClass("language-menu-open")?t("body").removeClass("language-menu-open"):t("body").removeClass("mobilemenu-open"),t(".edy-ecommerce-shopping-cart-button").length>0&&(t("body").addClass("edy-checkout-button-visible"),t(".edy-ecommerce-shopping-cart-button").show())}),t(".language-menu-btn").on("click",function(e){e.preventDefault(),t("body").addClass("language-menu-open")}),t(".comment-form-focus-input").focus(function(){t(this).hide();t(this).closest(".comment-form").find(".form_area").show().find("textarea").focus(),o()}),t("body").hasClass("front-page")&&(e(),t(window).resize(n(e,100))),t("body").hasClass("front-page")||(o(),t(window).resize(n(o,100))),t(".comment-form").hasClass("form_with_errors")?t("html, body").scrollTop(t(".comment-form").offset().top):t("form").find(".form_error, .form_notice").length>0&&t("html, body").scrollTop(t(".form_error, .form_notice").closest("form").offset().top)});var e=function(){t(".main-menu").removeAttr("style"),t(".header-row .content-full").removeAttr("style"),t(".center-row .content-inner").removeAttr("style"),t(".center-row .content-inner .inner-bottom").removeAttr("style");var e=Math.round(.31*t(window).height()),o=(t(".header-row .content-full").css("min-height",e),t(window).height(),t(document).height()),n=t(".topbar").height(),i=t(".header-row").height(),r=t(".center-row").height(),s=t(".footer-row").height(),a=o-s-i-2*parseInt(t(".center-row .inner-padding").css("padding-top")),c=o-i-r-s,l=o-i-r-s-n;if(t(document).width()>=1024){if(editmode())t("#edy-bar").height(),t(".center-row .content-inner").css("min-height",a);else t(".center-row .content-inner").css("min-height",a);var h=t(".content-left .content-inner").height(),u=t(".content-right .content-inner").height(),d=t(".content-left .content-inner .inner-bottom").height(),f=t(".content-right .content-inner .inner-bottom").height();h<d&&t(".center-row .content-left .inner-bottom").css("position","relative"),u<f&&t(".center-row .content-right .inner-bottom").css("position","relative");var p=t(".content-left .content-inner").height(),g=t(".content-right .content-inner").height();if(p>g){var m=p;t(".center-row .content-inner").css("min-height",m)}if(p<g){m=g;t(".center-row .content-inner").css("min-height",m)}}if(c>0&&t(document).width()<1024){var b=l+t(".content-left .content-inner").height();t(".content-left .content-inner").css("min-height",b)}if(t(document).width()<1024){h=t(".content-left .content-inner").height(),u=t(".content-right .content-inner").height(),d=t(".content-left .content-inner .inner-bottom").height(),f=t(".content-right .content-inner .inner-bottom").height();h<d&&t(".center-row .content-left .inner-bottom").css("position","relative"),u<f&&t(".center-row .content-right .inner-bottom").css("position","relative")}},o=function(){if(t(window).width()>600){var e=parseInt(t(".sidebar-inner").css("padding-bottom")),o=t(".main > footer").height();if(e<o)t(".sidebar-inner").css("padding-bottom",o);t(".js-content-top").removeAttr("style");var n=t(document).height();if(t(".js-content-top").height()<n)t(".js-content-top").css("min-height",n)}else t(".js-content-top").css("min-height",0)}}(jQuery),function(t){t.fn.extend({jsPopupMenu:function(e){return this.each(function(){var e=t(this),o=e.find(".js-popup-menu-btn"),n=e.find(".js-popup-menu-popover");n.hide(),o.on("click",function(e){e.preventDefault(),n.is(":hidden")&&(n.show(),o.addClass("open"),setTimeout(function(){t(document).on("click.js-popup-menu-click",function(){n.hide(),o.removeClass("open"),t(this).off(".js-popup-menu-click")})},0))})}),this}})}(jQuery),function(t){t.jquerySelect={init:function(e,o){e.wrap('<div class="jq-select" />');var n=e.parent(),i=t('<div class="jq-select-arrow"></div>'),r=t('<div class="jq-select-content" />'),s=t('<div class="jq-select-inner" />').text(e.children(":selected").text());r.append(s),n.append(r),n.append(i),e.hasClass("form_field_size_large")?(e.removeClass("form_field_size_large"),n.addClass("form_field_size_large")):e.hasClass("form_field_size_medium")?(e.removeClass("form_field_size_medium"),n.addClass("form_field_size_medium")):e.hasClass("form_field_size_small")?(e.removeClass("form_field_size_small"),n.addClass("form_field_size_small")):n.addClass("form_field_size_small"),e.change(t.proxy(function(){s.text(e.children(":selected").text())},this)),e.keyup(t.proxy(function(){s.text(e.children(":selected").text())},this)),e.bind("update",t.proxy(function(){s.text(e.children(":selected").text())},this))}},t.fn.extend({jqSelect:function(e){return this.each(function(){var o=t.extend({},e);t.jquerySelect.init(t(this),o)}),this}})}(jQuery),function(t){var e=t("body").hasClass("blog-article-page"),o=function(e,o){return function(e,o){if(e&&o){"string"==typeof e&&(e=e.replace(/rgba?\(/,"").replace(/\)/,"").split(","),t.each(e,function(t,o){e[t]=+o})),"string"==typeof o&&(o=o.replace(/rgba?\(/,"").replace(/\)/,"").split(","),t.each(o,function(t,e){o[t]=+e})),"object"==typeof e&&e.hasOwnProperty("length")&&3==e.length&&e.push(1),"object"==typeof o&&o.hasOwnProperty("length")&&3==o.length&&o.push(1);var n=[0,0,0,0];return n[3]=1-(1-o[3])*(1-e[3]),0===n[3]&&(n[3]=1e-6),n[0]=Math.min(o[0]*o[3]/n[3]+e[0]*e[3]*(1-o[3])/n[3],255),n[1]=Math.min(o[1]*o[3]/n[3]+e[1]*e[3]*(1-o[3])/n[3],255),n[2]=Math.min(o[2]*o[3]/n[3]+e[2]*e[3]*(1-o[3])/n[3],255),t.map(n,function(t){return Math.floor(t)})}}(e||[255,255,255,1],o||[255,255,255,1])},n=function(t,e){var n=o(t,e);return Math.round((.2126*+n[0]+.7152*+n[1]+.0722*+n[2])/2.55)/100},i=function(t,e,o){var n=t.find(".js-content-item-img-drop-area"),i=t.find(".js-toggle-crop-state");e>o?n.removeClass("image-landscape image-square image-portrait").addClass("image-landscape"):e===o?n.removeClass("image-landscape image-square image-portrait").addClass("image-square"):n.removeClass("image-landscape image-square image-portrait").addClass("image-portrait"),n.hasClass("image-square")?i.removeClass("is-visible").addClass("is-hidden"):i.removeClass("is-hidden").addClass("is-visible")},r=function(e,o,n,i,r){var s="article"===r?"articles":"pages",a=new Edicy.CustomData({type:r,id:n});t.ajax({type:"PATCH",contentType:"application/json",url:"/admin/api/"+s+"/"+n,data:JSON.stringify({image_id:i}),dataType:"json",success:function(t){a.set("image_crop_state","not-cropped"),e.removeClass("not-loaded with-error").addClass("is-loaded"),e.find(".edy-img-drop-area-placeholder").css("opacity",1),o.css("opacity",1)},timeout:3e4,error:function(t){e.removeClass("not-loaded is-loaded with-error").addClass("with-error")}})};window.site=t.extend(window.site||{},{bindContentItemImgDropAreas:function(e){t(".js-content-item-img-drop-area").each(function(o,n){var s=t(n),a=s.closest(".js-content-item-box"),c=a.data("item-id"),l=a.data("item-type");new Edicy.CustomData({type:l,id:c}),new Edicy.ImgDropArea(s,{positionable:!1,target_width:1280,placeholder:'<div class="edy-img-drop-area-placeholder">'+e+"</div>",removeBtn:'<div class="edy-img-drop-area-remove-image"><div class="edy-img-drop-area-remove-image-ico"><svg width="16" height="20" viewBox="0 0 26 30" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="currentColor"><g transform="translate(2 5)"><path d="M0 .997h2V21c0 1 1 2 2 2h14c1 0 2-1 2-2V1h2v20c0 2.25-1.75 4-4 4H4c-2.25 0-4-1.75-4-4V.997z"/><rect x="10" y="4" width="2" height="16" rx="1"/><rect x="5" y="4" width="2" height="16" rx="1"/><rect x="15" y="4" width="2" height="16" rx="1"/></g><path d="M26 4v2H0V4h7V2c0-1 1-2 2-2h8c1 0 2 1 2 2v2h7zM9 4h8V3c0-.5-.5-1-1-1h-6c-.5 0-1 .5-1 1v1z"/></g></svg></div></div>',change:function(t){var e;s.removeClass("is-cropped").addClass("not-cropped").css("opacity",.1),t?(e=t.original_id,a.removeClass("without-image is-loaded with-error").addClass("with-image not-loaded"),i(a,t.width,t.height)):(e=null,a.removeClass("with-image is-loaded with-error").addClass("without-image not-loaded"),a.find(".edy-img-drop-area-placeholder").css("opacity",0)),r(a,s,c,e,l)}})})},bindContentItemImageCropToggle:function(){t(".js-toggle-crop-state").on("click",function(){var e,o=t(this).closest(".js-content-item-box"),n=o.find(".js-content-item-img-drop-area"),i=o.data("item-id"),r=o.data("item-type"),s=new Edicy.CustomData({type:r,id:i});n.hasClass("is-cropped")?(n.removeClass("is-cropped").addClass("not-cropped"),e="not-cropped"):(n.removeClass("not-cropped").addClass("is-cropped"),e="is-cropped"),s.set("image_crop_state",e)})},initItemsPage:function(){t("html").hasClass("editmode")||(t(document).ready(function(){setTimeout(function(){t(".js-content-item-box").addClass("not-loaded")},3e3)}),t(".js-lazyload").lazyload({threshold:500,effect:"fadeIn",placeholder:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",load:function(){var e=t(this).closest(".js-content-item-box");e.removeClass("not-loaded with-error").addClass("is-loaded"),setTimeout(function(){e.removeClass("not-loaded with-error"),e.find(".js-loader").remove()},3e3)}}))},bindRootItemSettings:function(e){"show_product_related_pages_in_main_menu"in e||(e.show_product_related_pages_in_main_menu=!1),t(".js-root-item-settings-toggle").each(function(o,n){new Edicy.SettingsEditor(n,{menuItems:[{titleI18n:"show_in_main_menu",type:"checkbox",key:"show_product_related_pages_in_main_menu",states:{on:!0,off:!1}}],buttonTitleI18n:"settings",values:e,containerClass:["js-root-item-settings-popover","js-prevent-sideclick"],preview:function(e){1==!e.show_product_related_pages_in_main_menu?t(".js-menu-item-products").addClass("is-hidden"):t(".js-menu-item-products").removeClass("is-hidden")},commit:function(t){siteData.set("settings_root_item",t)}})})},contentHalfBgPreview:function(e,o,i){var r=function(){contentHalfBgCombinedLightness>=.5?t(o).find(".js-background-type").addClass("light-background").removeClass("dark-background"):t(o).find(".js-background-type").addClass("dark-background").removeClass("light-background")},s=e.imageSizes?function(t,e){for(var o,n=0,i=t.length;n<i;n++){if(t[n].width<e)return o||t[n];o=t[n]}return t[t.length-1]}(e.imageSizes,t(window).width()):"none",a=t(o).css("background-image"),c=e.image&&""!==e.image?"url("+s.url+")":"none",l=e.imageSizes&&""!==e.imageSizes?e.imageSizes:null,h=e.color&&""!==e.color?e.color:"rgba(0,0,0,0)",u=(e.colorData&&""!==e.colorData&&e.colorData.a,e.colorData&&""!==e.colorData&&e.colorData.lightness,t("<img>")),d=t("<canvas>"),f=e.image&&""!==e.image?e.image:null;f?function(t,e){for(var o=t.length;o--;)if(e.indexOf(t[o].url.trim())>-1)return!0;return!1}(l,a)?(contentHalfBgCombinedLightness=n(i.contentHalfBgImageColor,h),r()):(u.attr("src",f.replace(/.*\/(photos|voogstock)/g,"/photos")),u.on("load",function(){ColorExtract.extract(u[0],d[0],function(t){i.contentHalfBgImageColor=t.bgColor?t.bgColor:"rgba(255,255,255,1)",contentHalfBgCombinedLightness=n(i.contentHalfBgImageColor,h),r()})})):(contentHalfBgCombinedLightness=n("rgba(255,255,255,1)",h),r()),c.split("/").pop()!=a.split("/").pop()&&t(o).css({"background-image":c}),t(o).find(".background-color").css({"background-color":h})},contentHalfBgCommit:function(o,n){var i,r=t.extend(!0,{},o);r.image=o.image||"",r.imageSizes=null==(i=o.imageSizes)||"string"==typeof i&&i.match(/^[\\'"]+$/)?"":i,r.color=o.color||"rgba(255,255,255,0)",r.combinedLightness=contentHalfBgCombinedLightness,e?Edicy.articles.currentArticle.setData(n,r):pageData.set(n,r)}})}(jQuery);